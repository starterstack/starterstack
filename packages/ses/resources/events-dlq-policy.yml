Type: AWS::SQS::QueuePolicy

Properties:
  PolicyDocument:
    Statement:
      - Effect: Allow
        Action:
          - 'sqs:SendMessage'
        Principal:
          Service: 'events.amazonaws.com'
        Resource: !GetAtt eventsDlq.Arn
        Condition:
          ArnEquals:
            'aws:SourceArn': !Join
              - ''
              - - !Sub 'arn:${AWS::Partition}:events:${AWS::Region}:${AWS::AccountId}:rule/'
                - !Sub ${AWS::StackName}
                - '*'
      - Effect: Allow
        Action:
          - 'sqs:SendMessage'
        Principal:
          Service: 'sns.amazonaws.com'
        Resource: !GetAtt eventsDlq.Arn
        Condition:
          ArnEquals:
            'aws:SourceArn': !Join
              - ''
              - - !Sub 'arn:${AWS::Partition}:sns:${AWS::Region}:${AWS::AccountId}:'
                - !Sub ${AWS::StackName}
                - '*'
  Queues:
    - !Ref eventsDlq
